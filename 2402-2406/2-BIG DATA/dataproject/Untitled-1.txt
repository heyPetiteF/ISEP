Initial Air Quality Data:
   aqi   idx  ...                                forecast.daily.pm25                 debug.sync
0   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
1   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
2   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
3   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
4   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00

[5 rows x 23 columns]

Renamed Air Quality Data:
   aqi   idx  ...                                forecast.daily.pm25                 debug.sync
0   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
1   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
2   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
3   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
4   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00

[5 rows x 23 columns]

Air Quality Data after Dropping Columns with NAs:
   aqi   idx  ...                                forecast.daily.pm25                 debug.sync
0   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
1   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
2   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
3   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00
4   22  7397  ...  [{'avg': 34, 'day': '2024-06-12', 'max': 60, '...  2024-06-14T22:24:30+09:00

[5 rows x 22 columns]

Initial Flu Data:
  release_date region   issue  epiweek  lag  ...  num_age_5     wili      ili  start_date    end_date
0   2024-06-07     il  202422   202419    3  ...        NaN  1.18600  1.18600  2024-05-12  2024-05-18
1   2024-06-07     il  202422   202420    2  ...        NaN  1.20069  1.20069  2024-05-19  2024-05-25
2   2024-06-07     il  202422   202421    1  ...        NaN  1.04061  1.04061  2024-05-26  2024-06-01
3   2024-06-07     il  202422   202422    0  ...        NaN  1.07248  1.07248  2024-06-02  2024-06-08

[4 rows x 18 columns]

Formatted Date Columns in Flu Data:
  release_date start_date   end_date
0   2024-06-07 2024-05-12 2024-05-18
1   2024-06-07 2024-05-19 2024-05-25
2   2024-06-07 2024-05-26 2024-06-01
3   2024-06-07 2024-06-02 2024-06-08

Flu Data after Dropping Columns with NAs:
  release_date region   issue  epiweek  lag  ...  num_providers     wili      ili  start_date   end_date
0   2024-06-07     il  202422   202419    3  ...            176  1.18600  1.18600  2024-05-12 2024-05-18
1   2024-06-07     il  202422   202420    2  ...            175  1.20069  1.20069  2024-05-19 2024-05-25
2   2024-06-07     il  202422   202421    1  ...            173  1.04061  1.04061  2024-05-26 2024-06-01
3   2024-06-07     il  202422   202422    0  ...            145  1.07248  1.07248  2024-06-02 2024-06-08

[4 rows x 12 columns]

Data formatting complete. Formatted data saved as CSV.
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
24/06/14 15:42:40 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable

Data formatting using PySpark complete. Formatted data saved as Parquet.

Formatted Air Quality Data (Parquet):
+---+----+--------------------+-----------+----------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+
|aqi| idx|        attributions|dominentpol|      date|           city_geo|           city_name|            city_url|humidity|pressure|pm25|temperature|wind_speed|wind_gust|             time_s|time_tz|    time_v|           time_iso|   forecast_daily_o3| forecast_daily_pm10| forecast_daily_pm25|         debug_sync|
+---+----+--------------------+-----------+----------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+
| 22|7397|[{'url': 'http://...|       pm25|2024-05-12|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 07:00:00| -06:00|1718348400|2024-06-14 15:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 15:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-13|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 07:00:00| -06:00|1718348400|2024-06-14 15:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 15:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-14|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 07:00:00| -06:00|1718348400|2024-06-14 15:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 15:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-15|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 07:00:00| -06:00|1718348400|2024-06-14 15:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 15:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-16|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 07:00:00| -06:00|1718348400|2024-06-14 15:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 15:24:30|
+---+----+--------------------+-----------+----------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+
only showing top 5 rows

Formatted Flu Data (Parquet):
+------------+------+------+-------+---+-------+------------+-------------+-------+-------+----------+----------+
|release_date|region| issue|epiweek|lag|num_ili|num_patients|num_providers|   wili|    ili|start_date|  end_date|
+------------+------+------+-------+---+-------+------------+-------------+-------+-------+----------+----------+
|  2024-06-07|    il|202422| 202419|  3|    862|       72681|          176|  1.186|  1.186|2024-05-12|2024-05-18|
|  2024-06-07|    il|202422| 202420|  2|    859|       71542|          175|1.20069|1.20069|2024-05-19|2024-05-25|
|  2024-06-07|    il|202422| 202421|  1|    719|       69094|          173|1.04061|1.04061|2024-05-26|2024-06-01|
|  2024-06-07|    il|202422| 202422|  0|    608|       56691|          145|1.07248|1.07248|2024-06-02|2024-06-08|
+------------+------+------+-------+---+-------+------------+-------------+-------+-------+----------+----------+

Date normalization to UTC complete.
Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
24/06/14 15:42:46 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable

Formatted Air Quality Data:
+---+----+--------------------+-----------+-------------------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+
|aqi| idx|        attributions|dominentpol|               date|           city_geo|           city_name|            city_url|humidity|pressure|pm25|temperature|wind_speed|wind_gust|             time_s|time_tz|    time_v|           time_iso|   forecast_daily_o3| forecast_daily_pm10| forecast_daily_pm25|         debug_sync|
+---+----+--------------------+-----------+-------------------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+
| 22|7397|[{'url': 'http://...|       pm25|2024-05-12 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-13 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-14 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-15 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|
| 22|7397|[{'url': 'http://...|       pm25|2024-05-16 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|
+---+----+--------------------+-----------+-------------------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+
only showing top 5 rows

Formatted Flu Data:
+-------------------+------+------+-------+---+-------+------------+-------------+-------+-------+-------------------+-------------------+
|       release_date|region| issue|epiweek|lag|num_ili|num_patients|num_providers|   wili|    ili|         start_date|           end_date|
+-------------------+------+------+-------+---+-------+------------+-------------+-------+-------+-------------------+-------------------+
|2024-06-07 02:00:00|    il|202422| 202419|  3|    862|       72681|          176|  1.186|  1.186|2024-05-12 02:00:00|2024-05-18 02:00:00|
|2024-06-07 02:00:00|    il|202422| 202420|  2|    859|       71542|          175|1.20069|1.20069|2024-05-19 02:00:00|2024-05-25 02:00:00|
|2024-06-07 02:00:00|    il|202422| 202421|  1|    719|       69094|          173|1.04061|1.04061|2024-05-26 02:00:00|2024-06-01 02:00:00|
|2024-06-07 02:00:00|    il|202422| 202422|  0|    608|       56691|          145|1.07248|1.07248|2024-06-02 02:00:00|2024-06-08 02:00:00|
+-------------------+------+------+-------+---+-------+------------+-------------+-------+-------+-------------------+-------------------+

Merged Data:
24/06/14 15:42:49 WARN SparkStringUtils: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
+---+----+--------------------+-----------+-------------------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+-------------------+------+------+-------+---+-------+------------+-------------+-------+-------+-------------------+-------------------+
|aqi| idx|        attributions|dominentpol|               date|           city_geo|           city_name|            city_url|humidity|pressure|pm25|temperature|wind_speed|wind_gust|             time_s|time_tz|    time_v|           time_iso|   forecast_daily_o3| forecast_daily_pm10| forecast_daily_pm25|         debug_sync|       release_date|region| issue|epiweek|lag|num_ili|num_patients|num_providers|   wili|    ili|         start_date|           end_date|
+---+----+--------------------+-----------+-------------------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+-------------------+------+------+-------+---+-------+------------+-------------+-------+-------+-------------------+-------------------+
| 22|7397|[{'url': 'http://...|       pm25|2024-06-07 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|2024-06-07 02:00:00|    il|202422| 202422|  0|    608|       56691|          145|1.07248|1.07248|2024-06-02 02:00:00|2024-06-08 02:00:00|
| 22|7397|[{'url': 'http://...|       pm25|2024-06-07 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|2024-06-07 02:00:00|    il|202422| 202421|  1|    719|       69094|          173|1.04061|1.04061|2024-05-26 02:00:00|2024-06-01 02:00:00|
| 22|7397|[{'url': 'http://...|       pm25|2024-06-07 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|2024-06-07 02:00:00|    il|202422| 202420|  2|    859|       71542|          175|1.20069|1.20069|2024-05-19 02:00:00|2024-05-25 02:00:00|
| 22|7397|[{'url': 'http://...|       pm25|2024-06-07 02:00:00|[41.9136, -87.7239]|Chi_sp, Illinois,...|https://aqicn.org...|    44.5|  1015.9|22.0|       24.8|       2.5|      4.0|2024-06-14 05:00:00| -06:00|1718348400|2024-06-14 13:00:00|[{'avg': 16, 'day...|[{'avg': 10, 'day...|[{'avg': 34, 'day...|2024-06-14 13:24:30|2024-06-07 02:00:00|    il|202422| 202419|  3|    862|       72681|          176|  1.186|  1.186|2024-05-12 02:00:00|2024-05-18 02:00:00|
+---+----+--------------------+-----------+-------------------+-------------------+--------------------+--------------------+--------+--------+----+-----------+----------+---------+-------------------+-------+----------+-------------------+--------------------+--------------------+--------------------+-------------------+-------------------+------+------+-------+---+-------+------------+-------------+-------+-------+-------------------+-------------------+

Data processing and merging using Spark complete. Combined data saved as Parquet.
Mean Squared Error: 3287.1111111111154
/Users/bisainan/anaconda3/lib/python3.11/site-packages/elasticsearch/_sync/client/__init__.py:399: SecurityWarning: Connecting to 'https://localhost:9200' using TLS with verify_certs=False is insecure
  _transport = transport_class(
/Users/bisainan/anaconda3/lib/python3.11/site-packages/urllib3/connectionpool.py:1056: InsecureRequestWarning: Unverified HTTPS request is being made to host 'localhost'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings
  warnings.warn(
Connected to Elasticsearch
/Users/bisainan/anaconda3/lib/python3.11/site-packages/urllib3/connectionpool.py:1056: InsecureRequestWarning: Unverified HTTPS request is being made to host 'localhost'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings
  warnings.warn(
/Users/bisainan/anaconda3/lib/python3.11/site-packages/urllib3/connectionpool.py:1056: InsecureRequestWarning: Unverified HTTPS request is being made to host 'localhost'. Adding certificate verification is strongly advised. See: https://urllib3.readthedocs.io/en/1.26.x/advanced-usage.html#ssl-warnings
  warnings.warn(
Data indexing complete. Data indexed to Elasticsearch.
Data pipeline complete.
(base) bisainan@bisainandebijibendiannao dataproject % 